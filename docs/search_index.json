[
["index.html", "Indicateurs de la Biodiversité 1 Dependencies", " Indicateurs de la Biodiversité Andrew MacDonald 2020-06-22 1 Dependencies library(rcoleo) library(tidyverse) library(lubridate) "],
["dl.html", "2 Download data", " 2 Download data The only point here is to demonstrate the workflow for downloading data # On retire les cellules (classe sf) depuis l&#39;API cells &lt;- rcoleo::sf_cells() obs &lt;- rcoleo::get_obs() sites_dl &lt;- rcoleo::sf_sites() # until there is a better way to obtain the data and parse the result (perhaps # in the form of a convenience function in rcoleo) we do this: obs_df &lt;- obs[[1]] %&gt;% map(&quot;body&quot;) %&gt;% map_df(~ select(.x, -closed_at)) all_obs &lt;- obs_df %&gt;% select(cell_code, site_code, date_obs, type, taxa = obs_species.taxa_name, var = obs_species.variable, val = obs_species.value) %&gt;% mutate(date_obs = lubridate::ymd(date_obs), # convert cover into pres/abs (right?) count = if_else(var == &quot;recouvrement&quot;, 1, val)) # CELLULES: On compte le nombre d&#39;observation/nombre espece par type, année et cellule obs_cells &lt;- all_obs %&gt;% group_by(cell_code, date_obs, type) %&gt;% summarise(n = sum(count)) %&gt;% ungroup sp_cells &lt;- all_obs %&gt;% select(cell_code, date_obs, type, taxa) %&gt;% distinct() %&gt;% group_by(cell_code, date_obs, type) %&gt;% summarise(n = n()) %&gt;% ungroup # CAMPAGNES sites &lt;- sites_dl %&gt;% select(site_code, off_station_code_id, type_milieu = type, geometry, site_id = id) # On prépare les jeux de données pour chacun des types de campagnes all_obs_con &lt;- all_obs %&gt;% filter(taxa != &quot;inconnu&quot;) microfaunes &lt;- subset(all_obs_con, type == &quot;insectes_sol&quot;) papillons &lt;- subset(all_obs_con, type == &quot;papilionidés&quot;) odonates &lt;- subset(all_obs_con, type == &quot;odonates&quot;) vegetation &lt;- subset(all_obs_con, type == &quot;végétation&quot;) "],
["sites.html", "3 Sites", " 3 Sites Summary data about the different sites obs_cells %&gt;% ggplot(aes(x = cell_code, y = n)) + geom_point() + facet_wrap(~type, scales = &quot;free_y&quot;) ## Warning: Removed 1 rows containing missing values (geom_point). "],
["references.html", "References", " References "]
]
